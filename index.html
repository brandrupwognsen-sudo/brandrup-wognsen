<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Whisky Ratings</title>
  <style>
    :root { --max: 1100px; --radius: 14px; }
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; margin: 0; background:#f6f6f7; color:#111; }
    header { padding: 28px 16px; background: #111; color: #fff; }
    header .wrap { max-width: var(--max); margin: 0 auto; }
    h1 { margin: 0 0 6px 0; font-size: 24px; }
    .sub { opacity: .8; font-size: 14px; }

    main { padding: 18px 16px 40px; }
    .wrap { max-width: var(--max); margin: 0 auto; }

    .panel { background:#fff; border-radius: var(--radius); padding: 14px; box-shadow: 0 6px 18px rgba(0,0,0,.06); margin-bottom: 16px; }
    .row { display:flex; gap:12px; flex-wrap: wrap; align-items: center; }
    .row > * { flex: 1; min-width: 180px; }

    input, select {
      width: 100%; padding: 10px 12px; border-radius: 12px; border: 1px solid #ddd; background:#fff;
      font-size: 14px;
    }

    .tabs { display:flex; gap:8px; flex-wrap: wrap; }
    .tab {
      border:1px solid #ddd; background:#fff; border-radius: 999px; padding: 8px 12px; cursor:pointer; font-size: 14px;
    }
    .tab.active { background:#111; color:#fff; border-color:#111; }

    canvas { width: 100% !important; height: 380px !important; }

    table { width: 100%; border-collapse: collapse; }
    th, td { text-align:left; padding: 10px; border-bottom: 1px solid #eee; font-size: 14px; }
    th { font-size: 12px; text-transform: uppercase; letter-spacing: .04em; color:#444; position: sticky; top: 0; background: #fff; }

    .cards { display:none; gap: 12px; }
    .card { background:#fff; border-radius: var(--radius); padding: 12px; border: 1px solid #eee; }
    .card h3 { margin: 0 0 6px; font-size: 16px; }
    .meta { display:flex; gap:10px; flex-wrap: wrap; color:#444; font-size: 13px; }
    .pill { background:#f1f1f3; border-radius: 999px; padding: 4px 8px; }
    .score { font-weight: 700; }

    @media (max-width: 760px) {
      .tableWrap { display:none; }
      .cards { display:grid; }
    }

    .footer { color:#666; font-size: 12px; padding: 10px 2px; }
    .error { color: #b00020; font-weight: 600; }
    .small { font-size: 12px; color:#666; }
  </style>
</head>
<body>
  
  <header>
    <div class="wrap">
      <h1>Whisky Ratings</h1>
      <div class="sub">Live data from Google Sheets</div>
    </div>
  </header>

  <main>
    <div class="wrap">

      <div class="panel">
        <div class="row">
          <div>
            <label class="small">Search</label>
            <input id="q" placeholder="Search producer, whisky, country…" />
          </div>
          <div>
            <label class="small">Country</label>
            <select id="country">
              <option value="">All</option>
            </select>
          </div>
          <div>
            <label class="small">Sort</label>
            <select id="sort">
              <option value="avg_desc">Avg score (high → low)</option>
              <option value="avg_asc">Avg score (low → high)</option>
              <option value="name_asc">Name (A → Z)</option>
              <option value="name_desc">Name (Z → A)</option>
            </select>
          </div>
        </div>
        <div id="status" class="footer"></div>
      </div>

      <div class="panel">
        <div class="row" style="justify-content: space-between;">
          <div class="tabs" id="tabs">
            <button class="tab active" data-mode="avg">Top 10 Overall</button>
            <button class="tab" data-mode="johan">Top 10 Johan</button>
            <button class="tab" data-mode="erik">Top 10 Erik</button>
          </div>
          <div class="small">Shows the top 10 in the current filtered view</div>
        </div>
        <canvas id="chart"></canvas>
      </div>

      <div class="panel tableWrap">
        <div style="overflow:auto; max-height: 520px;">
          <table>
            <thead>
              <tr>
                <th>Producer</th>
                <th>Whisky</th>
                <th>Country</th>
                <th>Avg</th>
                <th>Johan</th>
                <th>Erik</th>
                <th>Age</th>
                <th>ABV</th>
              </tr>
            </thead>
            <tbody id="tbody"></tbody>
          </table>
        </div>
      </div>

      <div class="cards" id="cards"></div>

      <div class="footer">
        If something looks off, it’s usually because a column name changed in the sheet.
      </div>
    </div>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="app.js"></script>
</body>
</html>
